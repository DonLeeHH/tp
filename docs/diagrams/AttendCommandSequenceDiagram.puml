@startuml
!include style.puml
skinparam ArrowFontStyle plain

box Logic LOGIC_COLOR_T1
participant ":LogicManager" as LogicManager LOGIC_COLOR
participant ":AddressBookParser" as AddressBookParser LOGIC_COLOR
participant ":AttendCommandParser" as AttendParser LOGIC_COLOR
participant "ac:AttendCommand" as AttendCmd LOGIC_COLOR
participant "r:CommandResult" as CommandResult LOGIC_COLOR
end box

box Model MODEL_COLOR_T1
participant "m:Model" as Model MODEL_COLOR
participant "c:TuitionClass" as Class MODEL_COLOR
participant "s:ClassSession" as Session MODEL_COLOR
end box

[-> LogicManager : execute("attend n/Alice Doe c/Sec2-Math-A s/Week1 status/PRESENT")
activate LogicManager
LogicManager -> AddressBookParser : parseCommand(...)
activate AddressBookParser
create AttendParser
AddressBookParser -> AttendParser
activate AttendParser
AttendParser --> AddressBookParser
deactivate AttendParser

AddressBookParser -> AttendParser : parse(...)
activate AttendParser
AttendParser -> AttendParser : tokenize/validate
create AttendCmd
AttendParser -> AttendCmd
activate AttendCmd
AttendParser --> AddressBookParser : ac
deactivate AttendParser
deactivate AddressBookParser

LogicManager -> AttendCmd : execute(m)
activate AttendCmd

AttendCmd -> Model : findPersonByName("Alice Doe")
activate Model
Model --> AttendCmd : person
deactivate Model
AttendCmd -> AttendCmd : assert role == STUDENT

AttendCmd -> Model : getClassByName("Sec2-Math-A")
activate Model
Model --> AttendCmd : c
deactivate Model

AttendCmd -> Class : isStudent(person)?
AttendCmd -> Class : getSessionByName("Week1")
Class --> AttendCmd : s
AttendCmd -> Session : setAttendance(person, PRESENT)
AttendCmd -> Model : updateClass(c) & save
activate Model
Model --> AttendCmd
deactivate Model

create CommandResult
AttendCmd -> CommandResult
AttendCmd --> LogicManager : r
deactivate AttendCmd
[<-- LogicManager
deactivate LogicManager

note right of AttendCmd
  Errors:
  - Student not found/ambiguous
  - Not a STUDENT
  - Class/session not found
  - Student not enrolled in class
end note
@enduml
